$ opam depext -iy -j 2 async_ssl.v0.9.0
# Detecting depexts using vars: arch=x86_64, os=linux, os-distribution=fedora, os-family=fedora
# The following system packages are needed:
m4
openssl-devel
pkgconfig
Name        : m4
Version     : 1.4.18
Release     : 6.fc28
Architecture: x86_64
Install Date: Thu Aug 30 20:08:47 2018
Group       : Applications/Text
Size        : 372272
License     : GPLv3+
Signature   : RSA/SHA256, Sun Feb 25 11:01:47 2018, Key ID e08e7e629db62fb1
Source RPM  : m4-1.4.18-6.fc28.src.rpm
Build Date  : Sun Feb 25 10:58:14 2018
Build Host  : buildvm-25.phx2.fedoraproject.org
Relocations : (not relocatable)
Packager    : Fedora Project
Vendor      : Fedora Project
URL         : http://www.gnu.org/software/m4/
Bug URL     : https://bugz.fedoraproject.org/m4
Summary     : The GNU macro processor
Description :
A GNU implementation of the traditional UNIX macro processor.  M4 is
useful for writing text files which can be logically parsed, and is used
by many programs as part of their build process.  M4 has built-in
functions for including files, running shell commands, doing arithmetic,
etc.  The autoconf program needs m4 for generating configure scripts, but
not for running configure scripts.

Install m4 if you need a macro processor.
package openssl-devel is not installed
package pkgconfig is not installed
# The following new OS packages need to be installed: openssl-devel pkgconfig
The following command needs to be run through "sudo":
    yum install -y openssl-devel pkgconfig
Fedora 28 - x86_64 - Updates                     46 MB/s |  23 MB     00:00    
Last metadata expiration check: 0:00:10 ago on Fri Aug 31 04:11:53 2018.
Package pkgconf-pkg-config-1.4.2-1.fc28.x86_64 is already installed, skipping.
Dependencies resolved.
================================================================================
 Package                  Arch        Version                Repository    Size
================================================================================
Installing:
 openssl-devel            x86_64      1:1.1.0h-3.fc28        fedora       1.9 M
Upgrading:
 pcre2                    x86_64      10.31-10.fc28          updates      237 k
Installing dependencies:
 keyutils-libs-devel      x86_64      1.5.10-6.fc28          fedora        47 k
 krb5-devel               x86_64      1.16.1-13.fc28         updates      545 k
 libcom_err-devel         x86_64      1.44.2-0.fc28          updates       37 k
 libkadm5                 x86_64      1.16.1-13.fc28         updates      182 k
 libselinux-devel         x86_64      2.8-1.fc28             updates      197 k
 libsepol-devel           x86_64      2.8-1.fc28             updates       84 k
 libverto-devel           x86_64      0.3.0-5.fc28           fedora        17 k
 pcre2-devel              x86_64      10.31-10.fc28          updates      589 k
 pcre2-utf16              x86_64      10.31-10.fc28          updates      222 k
 pcre2-utf32              x86_64      10.31-10.fc28          updates      213 k
 zlib-devel               x86_64      1.2.11-8.fc28          updates       55 k

Transaction Summary
================================================================================
Install  12 Packages
Upgrade   1 Package

Total download size: 4.3 M
Downloading Packages:
(1/13): libkadm5-1.16.1-13.fc28.x86_64.rpm      2.3 MB/s | 182 kB     00:00    
(2/13): krb5-devel-1.16.1-13.fc28.x86_64.rpm    6.2 MB/s | 545 kB     00:00    
(3/13): zlib-devel-1.2.11-8.fc28.x86_64.rpm     5.3 MB/s |  55 kB     00:00    
(4/13): libcom_err-devel-1.44.2-0.fc28.x86_64.r 4.3 MB/s |  37 kB     00:00    
(5/13): libselinux-devel-2.8-1.fc28.x86_64.rpm   13 MB/s | 197 kB     00:00    
(6/13): libsepol-devel-2.8-1.fc28.x86_64.rpm    7.3 MB/s |  84 kB     00:00    
(7/13): libverto-devel-0.3.0-5.fc28.x86_64.rpm  469 kB/s |  17 kB     00:00    
(8/13): keyutils-libs-devel-1.5.10-6.fc28.x86_6 1.1 MB/s |  47 kB     00:00    
(9/13): pcre2-utf16-10.31-10.fc28.x86_64.rpm     13 MB/s | 222 kB     00:00    
(10/13): pcre2-devel-10.31-10.fc28.x86_64.rpm    17 MB/s | 589 kB     00:00    
(11/13): pcre2-utf32-10.31-10.fc28.x86_64.rpm    12 MB/s | 213 kB     00:00    
(12/13): openssl-devel-1.1.0h-3.fc28.x86_64.rpm 9.9 MB/s | 1.9 MB     00:00    
(13/13): pcre2-10.31-10.fc28.x86_64.rpm         8.7 MB/s | 237 kB     00:00    
--------------------------------------------------------------------------------
Total                                           3.3 MB/s | 4.3 MB     00:01     
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Preparing        :                                                        1/1 
  Upgrading        : pcre2-10.31-10.fc28.x86_64                            1/14 
  Installing       : pcre2-utf32-10.31-10.fc28.x86_64                      2/14 
  Installing       : pcre2-utf16-10.31-10.fc28.x86_64                      3/14 
  Installing       : pcre2-devel-10.31-10.fc28.x86_64                      4/14 
  Installing       : libverto-devel-0.3.0-5.fc28.x86_64                    5/14 
  Installing       : keyutils-libs-devel-1.5.10-6.fc28.x86_64              6/14 
  Installing       : libsepol-devel-2.8-1.fc28.x86_64                      7/14 
  Installing       : libselinux-devel-2.8-1.fc28.x86_64                    8/14 
  Installing       : libcom_err-devel-1.44.2-0.fc28.x86_64                 9/14 
  Installing       : zlib-devel-1.2.11-8.fc28.x86_64                      10/14 
  Installing       : libkadm5-1.16.1-13.fc28.x86_64                       11/14 
  Installing       : krb5-devel-1.16.1-13.fc28.x86_64                     12/14 
  Installing       : openssl-devel-1:1.1.0h-3.fc28.x86_64                 13/14 
  Cleanup          : pcre2-10.31-8.fc28.x86_64                            14/14 
  Running scriptlet: pcre2-10.31-8.fc28.x86_64                            14/14 
  Verifying        : openssl-devel-1:1.1.0h-3.fc28.x86_64                  1/14 
  Verifying        : krb5-devel-1.16.1-13.fc28.x86_64                      2/14 
  Verifying        : libkadm5-1.16.1-13.fc28.x86_64                        3/14 
  Verifying        : zlib-devel-1.2.11-8.fc28.x86_64                       4/14 
  Verifying        : libcom_err-devel-1.44.2-0.fc28.x86_64                 5/14 
  Verifying        : libselinux-devel-2.8-1.fc28.x86_64                    6/14 
  Verifying        : libsepol-devel-2.8-1.fc28.x86_64                      7/14 
  Verifying        : keyutils-libs-devel-1.5.10-6.fc28.x86_64              8/14 
  Verifying        : libverto-devel-0.3.0-5.fc28.x86_64                    9/14 
  Verifying        : pcre2-devel-10.31-10.fc28.x86_64                     10/14 
  Verifying        : pcre2-utf16-10.31-10.fc28.x86_64                     11/14 
  Verifying        : pcre2-utf32-10.31-10.fc28.x86_64                     12/14 
  Verifying        : pcre2-10.31-10.fc28.x86_64                           13/14 
  Verifying        : pcre2-10.31-8.fc28.x86_64                            14/14 

Installed:
  openssl-devel.x86_64 1:1.1.0h-3.fc28 keyutils-libs-devel.x86_64 1.5.10-6.fc28
  krb5-devel.x86_64 1.16.1-13.fc28     libcom_err-devel.x86_64 1.44.2-0.fc28   
  libkadm5.x86_64 1.16.1-13.fc28       libselinux-devel.x86_64 2.8-1.fc28      
  libsepol-devel.x86_64 2.8-1.fc28     libverto-devel.x86_64 0.3.0-5.fc28      
  pcre2-devel.x86_64 10.31-10.fc28     pcre2-utf16.x86_64 10.31-10.fc28        
  pcre2-utf32.x86_64 10.31-10.fc28     zlib-devel.x86_64 1.2.11-8.fc28         

Upgraded:
  pcre2.x86_64 10.31-10.fc28                                                    

Complete!
The following command needs to be run through "sudo":
    rpm -q --whatprovides openssl-devel pkgconfig
openssl-devel-1.1.0h-3.fc28.x86_64
pkgconf-pkg-config-1.4.2-1.fc28.x86_64
# OS packages installation successful
# Now letting OPAM install the packages
The following actions will be performed:
  - install jane-street-headers     v0.9.0 [required by core_kernel]
  - install spawn                   v0.9.0 [required by core]
  - install re                      1.7.3  [required by ppx_expect]
  - install base-bytes              base   [required by ctypes]
  - install ocaml-compiler-libs     v0.9.0 [required by ppx_core]
  - install conf-pkg-config         1.1    [required by conf-openssl, ctypes]
  - install num                     1.1    [required by sexplib]
  - install octavius                1.2.0  [required by ppx_js_style]
  - install ppx_derivers            1.0    [required by ppx_type_conv]
  - install result                  1.3    [required by topkg]
  - install ocamlbuild              0.12.0 [required by integers]
  - install ppx_traverse_builtins   v0.9.0 [required by ppx_core, ppx_metaquot]
  - install conf-openssl            1      [required by async_ssl]
  - install sexplib                 v0.9.3 [required by core_kernel, core]
  - install ocaml-migrate-parsetree 1.0.11 [required by async_ssl]
  - install topkg                   0.9.1  [required by integers]
  - install base                    v0.9.4 [required by async_ssl]
  - install ppx_ast                 v0.9.2 [required by ppx_core]
  - install integers                0.2.2  [required by ctypes]
  - install typerep                 v0.9.0 [required by core_kernel]
  - install stdio                   v0.9.1 [required by async_ssl]
  - install ctypes                  0.14.0 [required by async_ssl]
  - install ppx_core                v0.9.3 [required by ppx_assert, ppx_inline_test]
  - install ppx_optcomp             v0.9.0 [required by ppx_driver]
  - install ppx_driver              v0.9.2 [required by async_ssl]
  - install variantslib             v0.9.0 [required by core_kernel]
  - install ppx_metaquot            v0.9.0 [required by ppx_assert, ppx_inline_test]
  - install ppx_let                 v0.9.0 [required by ppx_jane]
  - install ppx_here                v0.9.1 [required by ppx_assert, ppx_jane]
  - install fieldslib               v0.9.0 [required by core_kernel]
  - install ppx_type_conv           v0.9.1 [required by ppx_assert]
  - install ppx_pipebang            v0.9.0 [required by ppx_jane]
  - install ppx_optional            v0.9.0 [required by ppx_jane]
  - install ppx_js_style            v0.9.0 [required by ppx_base]
  - install ppx_inline_test         v0.9.2 [required by core_kernel]
  - install ppx_fail                v0.9.0 [required by ppx_jane]
  - install ppx_variants_conv       v0.9.0 [required by bin_prot, ppx_jane]
  - install ppx_typerep_conv        v0.9.0 [required by ppx_jane]
  - install ppx_traverse            v0.9.0 [required by ppx_custom_printf, ppx_expect]
  - install ppx_sexp_conv           v0.9.0 [required by core_kernel]
  - install ppx_fields_conv         v0.9.0 [required by bin_prot, ppx_jane]
  - install ppx_enumerate           v0.9.0 [required by ppx_base]
  - install ppx_compare             v0.9.0 [required by bin_prot, ppx_assert]
  - install ppx_bench               v0.9.1 [required by ppx_jane]
  - install ppx_sexp_value          v0.9.0 [required by ppx_jane]
  - install ppx_sexp_message        v0.9.0 [required by core_kernel]
  - install ppx_custom_printf       v0.9.0 [required by bin_prot, ppx_jane]
  - install ppx_hash                v0.9.0 [required by core_kernel]
  - install ppx_assert              v0.9.0 [required by core_kernel, core]
  - install bin_prot                v0.9.2 [required by core_kernel]
  - install ppx_base                v0.9.0 [required by core_kernel]
  - install ppx_expect              v0.9.0 [required by ppx_jane]
  - install ppx_bin_prot            v0.9.0 [required by ppx_jane]
  - install configurator            v0.9.1 [required by async_ssl]
  - install ppx_jane                v0.9.0 [required by async_ssl]
  - install core_kernel             v0.9.1 [required by async_kernel, async_rpc_kernel]
  - install core                    v0.9.2 [required by async_ssl]
  - install async_kernel            v0.9.0 [required by async]
  - install async_unix              v0.9.1 [required by async]
  - install async_rpc_kernel        v0.9.0 [required by async_extra]
  - install async_extra             v0.9.0 [required by async]
  - install async                   v0.9.0 [required by async_ssl]
  - install async_ssl               v0.9.0
===== 63 to install =====

<><> Gathering sources ><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
[async.v0.9.0] found in cache
[async_extra.v0.9.0] found in cache
[async_kernel.v0.9.0] found in cache
[async_rpc_kernel.v0.9.0] found in cache
[async_ssl.v0.9.0] found in cache
[async_unix.v0.9.1] found in cache
[base.v0.9.4] found in cache
[bin_prot.v0.9.2] found in cache
[configurator.v0.9.1] found in cache
[core.v0.9.2] found in cache
[core_kernel.v0.9.1] found in cache
[ctypes.0.14.0] found in cache
[fieldslib.v0.9.0] found in cache
[integers.0.2.2] found in cache
[jane-street-headers.v0.9.0] found in cache
[num.1.1] found in cache
[ocaml-compiler-libs.v0.9.0] found in cache
[ocaml-migrate-parsetree.1.0.11] found in cache
[ocamlbuild.0.12.0] found in cache
[octavius.1.2.0] found in cache
[ppx_assert.v0.9.0] found in cache
[ppx_ast.v0.9.2] found in cache
[ppx_base.v0.9.0] found in cache
[ppx_bench.v0.9.1] found in cache
[ppx_bin_prot.v0.9.0] found in cache
[ppx_compare.v0.9.0] found in cache
[ppx_core.v0.9.3] found in cache
[ppx_custom_printf.v0.9.0] found in cache
[ppx_derivers.1.0] found in cache
[ppx_driver.v0.9.2] found in cache
[ppx_enumerate.v0.9.0] found in cache
[ppx_expect.v0.9.0] found in cache
[ppx_fail.v0.9.0] found in cache
[ppx_fields_conv.v0.9.0] found in cache
[ppx_hash.v0.9.0] found in cache
[ppx_here.v0.9.1] found in cache
[ppx_inline_test.v0.9.2] found in cache
[ppx_jane.v0.9.0] found in cache
[ppx_js_style.v0.9.0] found in cache
[ppx_let.v0.9.0] found in cache
[ppx_metaquot.v0.9.0] found in cache
[ppx_optcomp.v0.9.0] found in cache
[ppx_optional.v0.9.0] found in cache
[ppx_pipebang.v0.9.0] found in cache
[ppx_sexp_conv.v0.9.0] found in cache
[ppx_sexp_message.v0.9.0] found in cache
[ppx_sexp_value.v0.9.0] found in cache
[ppx_traverse.v0.9.0] found in cache
[ppx_traverse_builtins.v0.9.0] found in cache
[ppx_type_conv.v0.9.1] found in cache
[ppx_typerep_conv.v0.9.0] found in cache
[ppx_variants_conv.v0.9.0] found in cache
[re.1.7.3] found in cache
[result.1.3] found in cache
[sexplib.v0.9.3] found in cache
[spawn.v0.9.0] found in cache
[stdio.v0.9.1] found in cache
[topkg.0.9.1] found in cache
[typerep.v0.9.0] found in cache
[variantslib.v0.9.0] found in cache

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> installed base-bytes.base
-> installed conf-pkg-config.1.1
-> installed conf-openssl.1
-> installed jane-street-headers.v0.9.0
-> installed num.1.1
-> installed ocaml-compiler-libs.v0.9.0
-> installed ocamlbuild.0.12.0
-> installed octavius.1.2.0
-> installed ppx_derivers.1.0
-> installed ppx_traverse_builtins.v0.9.0
-> installed re.1.7.3
-> installed result.1.3
-> installed ocaml-migrate-parsetree.1.0.11
-> installed sexplib.v0.9.3
-> installed ppx_ast.v0.9.2
-> installed spawn.v0.9.0
-> installed topkg.0.9.1
-> installed integers.0.2.2
-> installed base.v0.9.4
-> installed ctypes.0.14.0
-> installed stdio.v0.9.1
-> installed typerep.v0.9.0
-> installed ppx_core.v0.9.3
-> installed ppx_optcomp.v0.9.0
-> installed ppx_driver.v0.9.2
-> installed fieldslib.v0.9.0
-> installed ppx_here.v0.9.1
-> installed ppx_let.v0.9.0
-> installed ppx_metaquot.v0.9.0
-> installed ppx_fail.v0.9.0
-> installed ppx_inline_test.v0.9.2
-> installed ppx_js_style.v0.9.0
-> installed ppx_optional.v0.9.0
-> installed ppx_pipebang.v0.9.0
-> installed ppx_type_conv.v0.9.1
-> installed ppx_bench.v0.9.1
-> installed ppx_compare.v0.9.0
-> installed ppx_enumerate.v0.9.0
-> installed ppx_fields_conv.v0.9.0
-> installed ppx_sexp_conv.v0.9.0
-> installed ppx_assert.v0.9.0
-> installed ppx_hash.v0.9.0
-> installed ppx_sexp_message.v0.9.0
-> installed ppx_sexp_value.v0.9.0
-> installed ppx_traverse.v0.9.0
-> installed ppx_base.v0.9.0
-> installed configurator.v0.9.1
-> installed ppx_typerep_conv.v0.9.0
-> installed variantslib.v0.9.0
-> installed ppx_custom_printf.v0.9.0
-> installed ppx_variants_conv.v0.9.0
-> installed bin_prot.v0.9.2
-> installed ppx_expect.v0.9.0
-> installed ppx_bin_prot.v0.9.0
-> installed ppx_jane.v0.9.0
-> installed core_kernel.v0.9.1
-> installed async_kernel.v0.9.0
-> installed core.v0.9.2
-> installed async_rpc_kernel.v0.9.0
-> installed async_unix.v0.9.1
-> installed async_extra.v0.9.0
-> installed async.v0.9.0
[ERROR] The compilation of async_ssl failed at "/home/opam/.opam/4.06/bin/jbuilder build -p async_ssl -j 71".

#=== ERROR while compiling async_ssl.v0.9.0 ===================================#
# context              2.0.0 | linux/x86_64 | ocaml-base-compiler.4.06.1 | git+file:///home/opam/opam-repository
# path                 ~/.opam/4.06/.opam-switch/build/async_ssl.v0.9.0
# command              ~/.opam/4.06/bin/jbuilder build -p async_ssl -j 71
# exit-code            1
# env-file             ~/.opam/log/async_ssl-10-c30956.env
# output-file          ~/.opam/log/async_ssl-10-c30956.out
### output ###
#         bash stubgen/ffi_ml_types_stubgen.exe (exit 1)
# (cd _build/default/stubgen && /usr/bin/bash -e -u -o pipefail -c 'gcc -O2 -fno-strict-aliasing -fwrapv -fPIC ffi_ml_types_stubgen.c $(< ../bindings/openssl-ccopt) $(< ../bindings/openssl-cclib) -I `dirname /home/opam/.opam/4.06/lib/ctypes/ctypes_cstubs_internals.h` -I /home/opam/.opam/4.06/lib/ocaml -o ffi_ml_types_stubgen.exe')
# ffi_ml_types_stubgen.c: In function 'main':
# ffi_ml_types_stubgen.c:39:49: error: 'SSL_CTRL_OPTIONS' undeclared (first use in this function); did you mean 'SSL_CTRL_CHAIN'?
#       enum { check_SSL_CTRL_OPTIONS_const = (int)SSL_CTRL_OPTIONS };
#                                                  ^~~~~~~~~~~~~~~~
#                                                  SSL_CTRL_CHAIN
# ffi_ml_types_stubgen.c:39:49: note: each undeclared identifier is reported only once for each function it appears in



<><> Error report <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
+- The following actions failed
| - build async_ssl v0.9.0
+- 
+- The following changes have been performed
| - install async                   v0.9.0
| - install async_extra             v0.9.0
| - install async_kernel            v0.9.0
| - install async_rpc_kernel        v0.9.0
| - install async_unix              v0.9.1
| - install base                    v0.9.4
| - install base-bytes              base
| - install bin_prot                v0.9.2
| - install conf-openssl            1
| - install conf-pkg-config         1.1
| - install configurator            v0.9.1
| - install core                    v0.9.2
| - install core_kernel             v0.9.1
| - install ctypes                  0.14.0
| - install fieldslib               v0.9.0
| - install integers                0.2.2
| - install jane-street-headers     v0.9.0
| - install num                     1.1
| - install ocaml-compiler-libs     v0.9.0
| - install ocaml-migrate-parsetree 1.0.11
| - install ocamlbuild              0.12.0
| - install octavius                1.2.0
| - install ppx_assert              v0.9.0
| - install ppx_ast                 v0.9.2
| - install ppx_base                v0.9.0
| - install ppx_bench               v0.9.1
| - install ppx_bin_prot            v0.9.0
| - install ppx_compare             v0.9.0
| - install ppx_core                v0.9.3
| - install ppx_custom_printf       v0.9.0
| - install ppx_derivers            1.0
| - install ppx_driver              v0.9.2
| - install ppx_enumerate           v0.9.0
| - install ppx_expect              v0.9.0
| - install ppx_fail                v0.9.0
| - install ppx_fields_conv         v0.9.0
| - install ppx_hash                v0.9.0
| - install ppx_here                v0.9.1
| - install ppx_inline_test         v0.9.2
| - install ppx_jane                v0.9.0
| - install ppx_js_style            v0.9.0
| - install ppx_let                 v0.9.0
| - install ppx_metaquot            v0.9.0
| - install ppx_optcomp             v0.9.0
| - install ppx_optional            v0.9.0
| - install ppx_pipebang            v0.9.0
| - install ppx_sexp_conv           v0.9.0
| - install ppx_sexp_message        v0.9.0
| - install ppx_sexp_value          v0.9.0
| - install ppx_traverse            v0.9.0
| - install ppx_traverse_builtins   v0.9.0
| - install ppx_type_conv           v0.9.1
| - install ppx_typerep_conv        v0.9.0
| - install ppx_variants_conv       v0.9.0
| - install re                      1.7.3
| - install result                  1.3
| - install sexplib                 v0.9.3
| - install spawn                   v0.9.0
| - install stdio                   v0.9.1
| - install topkg                   0.9.1
| - install typerep                 v0.9.0
| - install variantslib             v0.9.0
+- 
# Run eval $(opam env) to update the current shell environment

The former state can be restored with:
    opam switch import "/home/opam/.opam/4.06/.opam-switch/backup/state-20180831041210.export"
31 1535688707 1535689016