$ opam depext -iy -j 2 opus.0.1.0
# Detecting depexts using vars: arch=x86_64, os=linux, os-distribution=ubuntu, os-family=debian
# The following system packages are needed:
libavutil-dev
libogg-dev
libopus-dev
m4
pkg-config
The following command needs to be run through "sudo":
    apt-get install -qq -yy libavutil-dev libogg-dev libopus-dev m4 pkg-config
debconf: delaying package configuration, since apt-utils is not installed
Selecting previously unselected package libogg0:amd64.
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 15325 files and directories currently installed.)
Preparing to unpack .../00-libogg0_1.3.2-1_amd64.deb ...
Unpacking libogg0:amd64 (1.3.2-1) ...
Selecting previously unselected package libelf1:amd64.
Preparing to unpack .../01-libelf1_0.170-0.4_amd64.deb ...
Unpacking libelf1:amd64 (0.170-0.4) ...
Selecting previously unselected package libglib2.0-0:amd64.
Preparing to unpack .../02-libglib2.0-0_2.56.1-2ubuntu1_amd64.deb ...
Unpacking libglib2.0-0:amd64 (2.56.1-2ubuntu1) ...
Selecting previously unselected package libglib2.0-data.
Preparing to unpack .../03-libglib2.0-data_2.56.1-2ubuntu1_all.deb ...
Unpacking libglib2.0-data (2.56.1-2ubuntu1) ...
Selecting previously unselected package libicu60:amd64.
Preparing to unpack .../04-libicu60_60.2-3ubuntu3_amd64.deb ...
Unpacking libicu60:amd64 (60.2-3ubuntu3) ...
Selecting previously unselected package libxml2:amd64.
Preparing to unpack .../05-libxml2_2.9.4+dfsg1-6.1ubuntu1.2_amd64.deb ...
Unpacking libxml2:amd64 (2.9.4+dfsg1-6.1ubuntu1.2) ...
Selecting previously unselected package shared-mime-info.
Preparing to unpack .../06-shared-mime-info_1.9-2_amd64.deb ...
Unpacking shared-mime-info (1.9-2) ...
Selecting previously unselected package xdg-user-dirs.
Preparing to unpack .../07-xdg-user-dirs_0.17-1ubuntu1_amd64.deb ...
Unpacking xdg-user-dirs (0.17-1ubuntu1) ...
Selecting previously unselected package libdrm-common.
Preparing to unpack .../08-libdrm-common_2.4.91-2_all.deb ...
Unpacking libdrm-common (2.4.91-2) ...
Selecting previously unselected package libdrm2:amd64.
Preparing to unpack .../09-libdrm2_2.4.91-2_amd64.deb ...
Unpacking libdrm2:amd64 (2.4.91-2) ...
Selecting previously unselected package libva2:amd64.
Preparing to unpack .../10-libva2_2.1.0-3_amd64.deb ...
Unpacking libva2:amd64 (2.1.0-3) ...
Selecting previously unselected package libva-drm2:amd64.
Preparing to unpack .../11-libva-drm2_2.1.0-3_amd64.deb ...
Unpacking libva-drm2:amd64 (2.1.0-3) ...
Selecting previously unselected package libxfixes3:amd64.
Preparing to unpack .../12-libxfixes3_1%3a5.0.3-1_amd64.deb ...
Unpacking libxfixes3:amd64 (1:5.0.3-1) ...
Selecting previously unselected package libva-x11-2:amd64.
Preparing to unpack .../13-libva-x11-2_2.1.0-3_amd64.deb ...
Unpacking libva-x11-2:amd64 (2.1.0-3) ...
Selecting previously unselected package libvdpau1:amd64.
Preparing to unpack .../14-libvdpau1_1.1.1-3ubuntu1_amd64.deb ...
Unpacking libvdpau1:amd64 (1.1.1-3ubuntu1) ...
Selecting previously unselected package libavutil55:amd64.
Preparing to unpack .../15-libavutil55_7%3a3.4.4-0ubuntu0.18.04.1_amd64.deb ...
Unpacking libavutil55:amd64 (7:3.4.4-0ubuntu0.18.04.1) ...
Selecting previously unselected package libavutil-dev:amd64.
Preparing to unpack .../16-libavutil-dev_7%3a3.4.4-0ubuntu0.18.04.1_amd64.deb ...
Unpacking libavutil-dev:amd64 (7:3.4.4-0ubuntu0.18.04.1) ...
Selecting previously unselected package libdrm-amdgpu1:amd64.
Preparing to unpack .../17-libdrm-amdgpu1_2.4.91-2_amd64.deb ...
Unpacking libdrm-amdgpu1:amd64 (2.4.91-2) ...
Selecting previously unselected package libpciaccess0:amd64.
Preparing to unpack .../18-libpciaccess0_0.14-1_amd64.deb ...
Unpacking libpciaccess0:amd64 (0.14-1) ...
Selecting previously unselected package libdrm-intel1:amd64.
Preparing to unpack .../19-libdrm-intel1_2.4.91-2_amd64.deb ...
Unpacking libdrm-intel1:amd64 (2.4.91-2) ...
Selecting previously unselected package libdrm-nouveau2:amd64.
Preparing to unpack .../20-libdrm-nouveau2_2.4.91-2_amd64.deb ...
Unpacking libdrm-nouveau2:amd64 (2.4.91-2) ...
Selecting previously unselected package libdrm-radeon1:amd64.
Preparing to unpack .../21-libdrm-radeon1_2.4.91-2_amd64.deb ...
Unpacking libdrm-radeon1:amd64 (2.4.91-2) ...
Selecting previously unselected package libllvm6.0:amd64.
Preparing to unpack .../22-libllvm6.0_1%3a6.0-1ubuntu2_amd64.deb ...
Unpacking libllvm6.0:amd64 (1:6.0-1ubuntu2) ...
Selecting previously unselected package libogg-dev:amd64.
Preparing to unpack .../23-libogg-dev_1.3.2-1_amd64.deb ...
Unpacking libogg-dev:amd64 (1.3.2-1) ...
Selecting previously unselected package libopus0:amd64.
Preparing to unpack .../24-libopus0_1.1.2-1ubuntu1_amd64.deb ...
Unpacking libopus0:amd64 (1.1.2-1ubuntu1) ...
Selecting previously unselected package libopus-dev:amd64.
Preparing to unpack .../25-libopus-dev_1.1.2-1ubuntu1_amd64.deb ...
Unpacking libopus-dev:amd64 (1.1.2-1ubuntu1) ...
Selecting previously unselected package libsensors4:amd64.
Preparing to unpack .../26-libsensors4_1%3a3.4.0-4_amd64.deb ...
Unpacking libsensors4:amd64 (1:3.4.0-4) ...
Selecting previously unselected package libx11-xcb1:amd64.
Preparing to unpack .../27-libx11-xcb1_2%3a1.6.4-3ubuntu0.1_amd64.deb ...
Unpacking libx11-xcb1:amd64 (2:1.6.4-3ubuntu0.1) ...
Selecting previously unselected package libxcb-dri2-0:amd64.
Preparing to unpack .../28-libxcb-dri2-0_1.13-1_amd64.deb ...
Unpacking libxcb-dri2-0:amd64 (1.13-1) ...
Selecting previously unselected package libxcb-dri3-0:amd64.
Preparing to unpack .../29-libxcb-dri3-0_1.13-1_amd64.deb ...
Unpacking libxcb-dri3-0:amd64 (1.13-1) ...
Selecting previously unselected package libxcb-present0:amd64.
Preparing to unpack .../30-libxcb-present0_1.13-1_amd64.deb ...
Unpacking libxcb-present0:amd64 (1.13-1) ...
Selecting previously unselected package libxcb-sync1:amd64.
Preparing to unpack .../31-libxcb-sync1_1.13-1_amd64.deb ...
Unpacking libxcb-sync1:amd64 (1.13-1) ...
Selecting previously unselected package libxcb-xfixes0:amd64.
Preparing to unpack .../32-libxcb-xfixes0_1.13-1_amd64.deb ...
Unpacking libxcb-xfixes0:amd64 (1.13-1) ...
Selecting previously unselected package libxshmfence1:amd64.
Preparing to unpack .../33-libxshmfence1_1.3-1_amd64.deb ...
Unpacking libxshmfence1:amd64 (1.3-1) ...
Selecting previously unselected package mesa-va-drivers:amd64.
Preparing to unpack .../34-mesa-va-drivers_18.0.5-0ubuntu0~18.04.1_amd64.deb ...
Unpacking mesa-va-drivers:amd64 (18.0.5-0ubuntu0~18.04.1) ...
Selecting previously unselected package mesa-vdpau-drivers:amd64.
Preparing to unpack .../35-mesa-vdpau-drivers_18.0.5-0ubuntu0~18.04.1_amd64.deb ...
Unpacking mesa-vdpau-drivers:amd64 (18.0.5-0ubuntu0~18.04.1) ...
Selecting previously unselected package pkg-config.
Preparing to unpack .../36-pkg-config_0.29.1-0ubuntu2_amd64.deb ...
Unpacking pkg-config (0.29.1-0ubuntu2) ...
Selecting previously unselected package i965-va-driver:amd64.
Preparing to unpack .../37-i965-va-driver_2.1.0-0ubuntu1_amd64.deb ...
Unpacking i965-va-driver:amd64 (2.1.0-0ubuntu1) ...
Selecting previously unselected package va-driver-all:amd64.
Preparing to unpack .../38-va-driver-all_2.1.0-3_amd64.deb ...
Unpacking va-driver-all:amd64 (2.1.0-3) ...
Selecting previously unselected package vdpau-driver-all:amd64.
Preparing to unpack .../39-vdpau-driver-all_1.1.1-3ubuntu1_amd64.deb ...
Unpacking vdpau-driver-all:amd64 (1.1.1-3ubuntu1) ...
Setting up libxcb-present0:amd64 (1.13-1) ...
Setting up libxcb-dri2-0:amd64 (1.13-1) ...
Setting up libxcb-dri3-0:amd64 (1.13-1) ...
Setting up libicu60:amd64 (60.2-3ubuntu3) ...
Setting up libxcb-xfixes0:amd64 (1.13-1) ...
Setting up libxfixes3:amd64 (1:5.0.3-1) ...
Setting up libllvm6.0:amd64 (1:6.0-1ubuntu2) ...
Setting up libelf1:amd64 (0.170-0.4) ...
Setting up libglib2.0-0:amd64 (2.56.1-2ubuntu1) ...
No schema files found: doing nothing.
Setting up libxshmfence1:amd64 (1.3-1) ...
Setting up libvdpau1:amd64 (1.1.1-3ubuntu1) ...
Setting up libva2:amd64 (2.1.0-3) ...
Setting up libxml2:amd64 (2.9.4+dfsg1-6.1ubuntu1.2) ...
Setting up libopus0:amd64 (1.1.2-1ubuntu1) ...
Setting up libdrm-common (2.4.91-2) ...
Setting up libxcb-sync1:amd64 (1.13-1) ...
Setting up libogg0:amd64 (1.3.2-1) ...
Setting up pkg-config (0.29.1-0ubuntu2) ...
Setting up libx11-xcb1:amd64 (2:1.6.4-3ubuntu0.1) ...
Setting up libglib2.0-data (2.56.1-2ubuntu1) ...
Processing triggers for libc-bin (2.27-3ubuntu1) ...
Setting up libpciaccess0:amd64 (0.14-1) ...
Setting up libopus-dev:amd64 (1.1.2-1ubuntu1) ...
Setting up libsensors4:amd64 (1:3.4.0-4) ...
Setting up shared-mime-info (1.9-2) ...
Setting up libogg-dev:amd64 (1.3.2-1) ...
Setting up xdg-user-dirs (0.17-1ubuntu1) ...
Setting up libdrm2:amd64 (2.4.91-2) ...
Setting up libdrm-intel1:amd64 (2.4.91-2) ...
Setting up libva-drm2:amd64 (2.1.0-3) ...
Setting up libdrm-radeon1:amd64 (2.4.91-2) ...
Setting up libva-x11-2:amd64 (2.1.0-3) ...
Setting up libdrm-nouveau2:amd64 (2.4.91-2) ...
Setting up libavutil55:amd64 (7:3.4.4-0ubuntu0.18.04.1) ...
Setting up libdrm-amdgpu1:amd64 (2.4.91-2) ...
Setting up mesa-vdpau-drivers:amd64 (18.0.5-0ubuntu0~18.04.1) ...
Setting up i965-va-driver:amd64 (2.1.0-0ubuntu1) ...
Setting up mesa-va-drivers:amd64 (18.0.5-0ubuntu0~18.04.1) ...
Setting up vdpau-driver-all:amd64 (1.1.1-3ubuntu1) ...
Setting up libavutil-dev:amd64 (7:3.4.4-0ubuntu0.18.04.1) ...
Setting up va-driver-all:amd64 (2.1.0-3) ...
Processing triggers for libc-bin (2.27-3ubuntu1) ...
# OS packages installation successful
# Now letting OPAM install the packages
The following actions will be performed:
  - install ogg  0.5.2 [required by opus]
  - install opus 0.1.0
===== 2 to install =====

<><> Gathering sources ><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
[ogg.0.5.2] found in cache
[opus.0.1.0] found in cache

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> installed ogg.0.5.2
[ERROR] The compilation of opus failed at "/usr/bin/make".

#=== ERROR while compiling opus.0.1.0 =========================================#
# context              2.0.0 | linux/x86_64 | ocaml-base-compiler.4.06.1 | git+file:///home/opam/opam-repository
# path                 ~/.opam/4.06/.opam-switch/build/opus.0.1.0
# command              /usr/bin/make
# exit-code            2
# env-file             ~/.opam/log/opus-13-865888.env
# output-file          ~/.opam/log/opus-13-865888.out
### output ###
# /usr/bin/make -C src
# make[1]: Entering directory '/home/opam/.opam/4.06/.opam-switch/build/opus.0.1.0/src'
# make[2]: Entering directory '/home/opam/.opam/4.06/.opam-switch/build/opus.0.1.0/src'
# ocamldep.opt -I /home/opam/.opam/4.06/lib/ogg ogg_demuxer_opus_decoder.mli > ._bcdi/ogg_demuxer_opus_decoder.di
# ocamldep.opt -I /home/opam/.opam/4.06/lib/ogg opus.mli > ._bcdi/opus.di
# ocamldep.opt -I /home/opam/.opam/4.06/lib/ogg ogg_demuxer_opus_decoder.ml > ._d/ogg_demuxer_opus_decoder.d
# ocamldep.opt -I /home/opam/.opam/4.06/lib/ogg opus.ml > ._d/opus.d
# ocamlc.opt -c -cc "gcc" -ccopt "-fPIC -Wall -g -O2 -I/home/opam/.opam/4.06/include -I/usr/include/opus -I.. \
# 			-DPIC -fPIC -I/home/opam/.opam/4.06/include -I/usr/include/opus  \
# 			  -I/home/opam/.opam/4.06/lib/ogg  -o opus_stubs.o " opus_stubs.c
# ar rcs libopus_stubs.a  opus_stubs.o
# ocamlc.opt -c -dtypes -I /home/opam/.opam/4.06/lib/ogg opus.mli
# File "opus.mli", line 56, characters 46-58:
# Error: Unbound type constructor Ogg.Stream.t
# OCamlMakefile:1048: recipe for target 'opus.cmi' failed
# make[2]: *** [opus.cmi] Error 2
# make[2]: Leaving directory '/home/opam/.opam/4.06/.opam-switch/build/opus.0.1.0/src'
# OCamlMakefile:784: recipe for target 'byte-code-library' failed
# make[1]: *** [byte-code-library] Error 2
# make[1]: Leaving directory '/home/opam/.opam/4.06/.opam-switch/build/opus.0.1.0/src'
# Makefile:12: recipe for target 'all' failed
# make: *** [all] Error 2



<><> Error report <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
+- The following actions failed
| - build opus 0.1.0
+- 
+- The following changes have been performed
| - install ogg 0.5.2
+- 

The packages you requested declare the following system dependencies. Please make sure they are installed before retrying:
    libavutil-dev libopus-dev

# Run eval $(opam env) to update the current shell environment

The former state can be restored with:
    opam switch import "/home/opam/.opam/4.06/.opam-switch/backup/state-20180831213100.export"
31 1535751043 1535751067