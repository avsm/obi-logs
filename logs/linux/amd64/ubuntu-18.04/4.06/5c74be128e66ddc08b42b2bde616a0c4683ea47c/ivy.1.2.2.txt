$ opam depext -iy -j 2 ivy.1.2.2
# Detecting depexts using vars: arch=x86_64, os=linux, os-distribution=ubuntu, os-family=debian
# The following system packages are needed:
libglib2.0-dev
libpcre3-dev
m4
pkg-config
tcl-dev
The following command needs to be run through "sudo":
    apt-get install -qq -yy libglib2.0-dev libpcre3-dev m4 pkg-config tcl-dev
debconf: delaying package configuration, since apt-utils is not installed
Selecting previously unselected package libpython3.6-minimal:amd64.
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 15325 files and directories currently installed.)
Preparing to unpack .../libpython3.6-minimal_3.6.5-3_amd64.deb ...
Unpacking libpython3.6-minimal:amd64 (3.6.5-3) ...
Selecting previously unselected package python3.6-minimal.
Preparing to unpack .../python3.6-minimal_3.6.5-3_amd64.deb ...
Unpacking python3.6-minimal (3.6.5-3) ...
Setting up libpython3.6-minimal:amd64 (3.6.5-3) ...
Setting up python3.6-minimal (3.6.5-3) ...
Selecting previously unselected package python3-minimal.
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 15563 files and directories currently installed.)
Preparing to unpack .../0-python3-minimal_3.6.5-3ubuntu1_amd64.deb ...
Unpacking python3-minimal (3.6.5-3ubuntu1) ...
Selecting previously unselected package mime-support.
Preparing to unpack .../1-mime-support_3.60ubuntu1_all.deb ...
Unpacking mime-support (3.60ubuntu1) ...
Selecting previously unselected package libmpdec2:amd64.
Preparing to unpack .../2-libmpdec2_2.4.2-1ubuntu1_amd64.deb ...
Unpacking libmpdec2:amd64 (2.4.2-1ubuntu1) ...
Selecting previously unselected package libpython3.6-stdlib:amd64.
Preparing to unpack .../3-libpython3.6-stdlib_3.6.5-3_amd64.deb ...
Unpacking libpython3.6-stdlib:amd64 (3.6.5-3) ...
Selecting previously unselected package python3.6.
Preparing to unpack .../4-python3.6_3.6.5-3_amd64.deb ...
Unpacking python3.6 (3.6.5-3) ...
Selecting previously unselected package libpython3-stdlib:amd64.
Preparing to unpack .../5-libpython3-stdlib_3.6.5-3ubuntu1_amd64.deb ...
Unpacking libpython3-stdlib:amd64 (3.6.5-3ubuntu1) ...
Setting up python3-minimal (3.6.5-3ubuntu1) ...
Selecting previously unselected package python3.
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 15991 files and directories currently installed.)
Preparing to unpack .../00-python3_3.6.5-3ubuntu1_amd64.deb ...
Unpacking python3 (3.6.5-3ubuntu1) ...
Selecting previously unselected package libmagic-mgc.
Preparing to unpack .../01-libmagic-mgc_1%3a5.32-2ubuntu0.1_amd64.deb ...
Unpacking libmagic-mgc (1:5.32-2ubuntu0.1) ...
Selecting previously unselected package libmagic1:amd64.
Preparing to unpack .../02-libmagic1_1%3a5.32-2ubuntu0.1_amd64.deb ...
Unpacking libmagic1:amd64 (1:5.32-2ubuntu0.1) ...
Selecting previously unselected package file.
Preparing to unpack .../03-file_1%3a5.32-2ubuntu0.1_amd64.deb ...
Unpacking file (1:5.32-2ubuntu0.1) ...
Selecting previously unselected package libelf1:amd64.
Preparing to unpack .../04-libelf1_0.170-0.4_amd64.deb ...
Unpacking libelf1:amd64 (0.170-0.4) ...
Selecting previously unselected package libglib2.0-0:amd64.
Preparing to unpack .../05-libglib2.0-0_2.56.1-2ubuntu1_amd64.deb ...
Unpacking libglib2.0-0:amd64 (2.56.1-2ubuntu1) ...
Selecting previously unselected package libglib2.0-data.
Preparing to unpack .../06-libglib2.0-data_2.56.1-2ubuntu1_all.deb ...
Unpacking libglib2.0-data (2.56.1-2ubuntu1) ...
Selecting previously unselected package libicu60:amd64.
Preparing to unpack .../07-libicu60_60.2-3ubuntu3_amd64.deb ...
Unpacking libicu60:amd64 (60.2-3ubuntu3) ...
Selecting previously unselected package libxml2:amd64.
Preparing to unpack .../08-libxml2_2.9.4+dfsg1-6.1ubuntu1_amd64.deb ...
Unpacking libxml2:amd64 (2.9.4+dfsg1-6.1ubuntu1) ...
Selecting previously unselected package shared-mime-info.
Preparing to unpack .../09-shared-mime-info_1.9-2_amd64.deb ...
Unpacking shared-mime-info (1.9-2) ...
Selecting previously unselected package tzdata.
Preparing to unpack .../10-tzdata_2018d-1_all.deb ...
Unpacking tzdata (2018d-1) ...
Selecting previously unselected package xdg-user-dirs.
Preparing to unpack .../11-xdg-user-dirs_0.17-1ubuntu1_amd64.deb ...
Unpacking xdg-user-dirs (0.17-1ubuntu1) ...
Selecting previously unselected package libglib2.0-bin.
Preparing to unpack .../12-libglib2.0-bin_2.56.1-2ubuntu1_amd64.deb ...
Unpacking libglib2.0-bin (2.56.1-2ubuntu1) ...
Selecting previously unselected package python3-lib2to3.
Preparing to unpack .../13-python3-lib2to3_3.6.5-3_all.deb ...
Unpacking python3-lib2to3 (3.6.5-3) ...
Selecting previously unselected package python3-distutils.
Preparing to unpack .../14-python3-distutils_3.6.5-3_all.deb ...
Unpacking python3-distutils (3.6.5-3) ...
Selecting previously unselected package libglib2.0-dev-bin.
Preparing to unpack .../15-libglib2.0-dev-bin_2.56.1-2ubuntu1_amd64.deb ...
Unpacking libglib2.0-dev-bin (2.56.1-2ubuntu1) ...
Selecting previously unselected package libpcre16-3:amd64.
Preparing to unpack .../16-libpcre16-3_2%3a8.39-9_amd64.deb ...
Unpacking libpcre16-3:amd64 (2:8.39-9) ...
Selecting previously unselected package libpcre32-3:amd64.
Preparing to unpack .../17-libpcre32-3_2%3a8.39-9_amd64.deb ...
Unpacking libpcre32-3:amd64 (2:8.39-9) ...
Selecting previously unselected package libpcrecpp0v5:amd64.
Preparing to unpack .../18-libpcrecpp0v5_2%3a8.39-9_amd64.deb ...
Unpacking libpcrecpp0v5:amd64 (2:8.39-9) ...
Selecting previously unselected package libpcre3-dev:amd64.
Preparing to unpack .../19-libpcre3-dev_2%3a8.39-9_amd64.deb ...
Unpacking libpcre3-dev:amd64 (2:8.39-9) ...
Selecting previously unselected package pkg-config.
Preparing to unpack .../20-pkg-config_0.29.1-0ubuntu2_amd64.deb ...
Unpacking pkg-config (0.29.1-0ubuntu2) ...
Selecting previously unselected package zlib1g-dev:amd64.
Preparing to unpack .../21-zlib1g-dev_1%3a1.2.11.dfsg-0ubuntu2_amd64.deb ...
Unpacking zlib1g-dev:amd64 (1:1.2.11.dfsg-0ubuntu2) ...
Selecting previously unselected package libglib2.0-dev:amd64.
Preparing to unpack .../22-libglib2.0-dev_2.56.1-2ubuntu1_amd64.deb ...
Unpacking libglib2.0-dev:amd64 (2.56.1-2ubuntu1) ...
Selecting previously unselected package libtcl8.6:amd64.
Preparing to unpack .../23-libtcl8.6_8.6.8+dfsg-3_amd64.deb ...
Unpacking libtcl8.6:amd64 (8.6.8+dfsg-3) ...
Selecting previously unselected package tcl8.6.
Preparing to unpack .../24-tcl8.6_8.6.8+dfsg-3_amd64.deb ...
Unpacking tcl8.6 (8.6.8+dfsg-3) ...
Selecting previously unselected package tcl.
Preparing to unpack .../25-tcl_8.6.0+9_amd64.deb ...
Unpacking tcl (8.6.0+9) ...
Selecting previously unselected package tcl8.6-dev:amd64.
Preparing to unpack .../26-tcl8.6-dev_8.6.8+dfsg-3_amd64.deb ...
Unpacking tcl8.6-dev:amd64 (8.6.8+dfsg-3) ...
Selecting previously unselected package tcl-dev:amd64.
Preparing to unpack .../27-tcl-dev_8.6.0+9_amd64.deb ...
Unpacking tcl-dev:amd64 (8.6.0+9) ...
Setting up libicu60:amd64 (60.2-3ubuntu3) ...
Setting up mime-support (3.60ubuntu1) ...
Setting up tzdata (2018d-1) ...
debconf: unable to initialize frontend: Dialog
debconf: (Dialog frontend will not work on a dumb terminal, an emacs shell buffer, or without a controlling terminal.)
debconf: falling back to frontend: Readline

Current default time zone: 'Europe/London'
Local time is now:      Sun Aug 12 04:19:25 BST 2018.
Universal Time is now:  Sun Aug 12 03:19:25 UTC 2018.
Run 'dpkg-reconfigure tzdata' if you wish to change it.

Setting up libelf1:amd64 (0.170-0.4) ...
Setting up libglib2.0-0:amd64 (2.56.1-2ubuntu1) ...
No schema files found: doing nothing.
Setting up libxml2:amd64 (2.9.4+dfsg1-6.1ubuntu1) ...
Setting up libmagic-mgc (1:5.32-2ubuntu0.1) ...
Setting up libmagic1:amd64 (1:5.32-2ubuntu0.1) ...
Setting up pkg-config (0.29.1-0ubuntu2) ...
Setting up libglib2.0-data (2.56.1-2ubuntu1) ...
Processing triggers for libc-bin (2.27-3ubuntu1) ...
Setting up shared-mime-info (1.9-2) ...
Setting up libpcrecpp0v5:amd64 (2:8.39-9) ...
Setting up libpcre32-3:amd64 (2:8.39-9) ...
Setting up libpcre16-3:amd64 (2:8.39-9) ...
Setting up libtcl8.6:amd64 (8.6.8+dfsg-3) ...
Setting up libglib2.0-bin (2.56.1-2ubuntu1) ...
Setting up xdg-user-dirs (0.17-1ubuntu1) ...
Setting up libmpdec2:amd64 (2.4.2-1ubuntu1) ...
Setting up zlib1g-dev:amd64 (1:1.2.11.dfsg-0ubuntu2) ...
Setting up libpython3.6-stdlib:amd64 (3.6.5-3) ...
Setting up libpcre3-dev:amd64 (2:8.39-9) ...
Setting up python3.6 (3.6.5-3) ...
Setting up file (1:5.32-2ubuntu0.1) ...
Setting up tcl8.6 (8.6.8+dfsg-3) ...
Setting up tcl8.6-dev:amd64 (8.6.8+dfsg-3) ...
Setting up libpython3-stdlib:amd64 (3.6.5-3ubuntu1) ...
Setting up python3 (3.6.5-3ubuntu1) ...
running python rtupdate hooks for python3.6...
running python post-rtupdate hooks for python3.6...
Setting up tcl (8.6.0+9) ...
Setting up python3-lib2to3 (3.6.5-3) ...
Setting up tcl-dev:amd64 (8.6.0+9) ...
Setting up python3-distutils (3.6.5-3) ...
Setting up libglib2.0-dev-bin (2.56.1-2ubuntu1) ...
Setting up libglib2.0-dev:amd64 (2.56.1-2ubuntu1) ...
Processing triggers for libc-bin (2.27-3ubuntu1) ...
# OS packages installation successful
# Now letting OPAM install the packages
The following actions will be performed:
  - install conf-glib-2     1     [required by ivy]
  - install conf-pkg-config 1.1   [required by conf-libpcre, conf-tcl]
  - install conf-tcl        1     [required by ivy]
  - install conf-libpcre    1     [required by ivy]
  - install ivy             1.2.2
===== 5 to install =====

<><> Gathering sources ><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
[ivy.1.2.2] downloaded from http://www.eei.cena.fr/products/ivy/download/packages/ivy-ocaml_1.2-2.tar.gz

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> installed conf-glib-2.1
-> installed conf-pkg-config.1.1
-> installed conf-libpcre.1
-> installed conf-tcl.1
[ERROR] The compilation of ivy failed at "/usr/bin/make".

#=== ERROR while compiling ivy.1.2.2 ==========================================#
# context              2.0.0 | linux/x86_64 | ocaml-base-compiler.4.06.1 | git+file:///home/opam/opam-repository
# path                 ~/.opam/4.06/.opam-switch/build/ivy.1.2.2
# command              /usr/bin/make
# exit-code            2
# env-file             ~/.opam/log/ivy-13-d474c2.env
# output-file          ~/.opam/log/ivy-13-d474c2.out
### output ###
# ocamldep  *.mli *.ml > .depend
# ocamlc  -c ivy.mli
# ocamlc   -c ivy.ml
# File "ivy.ml", line 58, characters 10-23:
# Warning 3: deprecated: String.create
# Use Bytes.create instead.
# File "ivy.ml", line 61, characters 4-34:
# Warning 3: deprecated: String.set
# Use Bytes.set instead.
# File "ivy.ml", line 62, characters 4-39:
# Warning 3: deprecated: String.set
# Use Bytes.set instead.
# File "ivy.ml", line 68, characters 10-23:
# Warning 3: deprecated: String.create
# Use Bytes.create instead.
# File "ivy.ml", line 70, characters 4-69:
# Warning 3: deprecated: String.set
# Use Bytes.set instead.
# File "ivy.ml", line 77, characters 50-51:
# Error: This expression has type bytes but an expression was expected of type
#          string
# Makefile:136: recipe for target 'ivy.cmo' failed
# make: *** [ivy.cmo] Error 2



<><> Error report <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
+- The following actions failed
| - build ivy 1.2.2
+- 
+- The following changes have been performed
| - install conf-glib-2     1
| - install conf-libpcre    1
| - install conf-pkg-config 1.1
| - install conf-tcl        1
+- 
# Run eval $(opam env) to update the current shell environment

The former state can be restored with:
    opam switch import "/home/opam/.opam/4.06/.opam-switch/backup/state-20180812031928.export"
31 1534043949 1534043971